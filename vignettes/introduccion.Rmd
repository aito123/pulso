---
title: "Introduccion"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduccion}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(pulso)
```

<!-- WARNING - This vignette is generated by {fusen} from /dev/flat_minimal.Rmd: do not edit by hand -->

## Funciones de Pulso PUCP

Este paquete fue creado por Santiago Sotelo.


<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->


# Barra simple

```{r examples-barra_simple, eval = FALSE}

data_prueba %>% 
  barra_simple(gedad, ordenado=FALSE)

```

# Barra multiple

```{r examples-barra_multiple, eval = FALSE}


data_prueba %>% 
  filter(q0002 %in% 1) %>% 
  barra_multiple(starts_with("q0004_0"))


```

# Barra apilada 1

```{r examples-barra_apilada_1, eval = FALSE}

data_prueba_ruta <- system.file("data_prueba.sav", package = "pulso")
data_prueba <- haven::read_sav(data_prueba_ruta)

data_prueba %>% 
  filter(q0002 %in% 1) %>% 
  barra_apilada_1(q0003_0002)


```

# Barra apilada n

```{r examples-barra_apilada_n, eval = FALSE}

data_prueba_ruta <- system.file("data_prueba.sav", package = "pulso")
data_prueba <- haven::read_sav(data_prueba_ruta)

data_prueba %>% 
  barra_apilada_n(starts_with("q0011_"))

```

# Grafico donut

```{r examples-grafico_donut, eval = FALSE}

data_prueba_ruta <- system.file("data_prueba.sav", package = "pulso")
data_prueba <- haven::read_sav(data_prueba_ruta)

data_prueba %>% 
  grafico_donut(sexo)

```

# Grafico radar

```{r examples-grafico_radar, eval = FALSE}

data_prueba_ruta <- system.file("data_prueba.sav", package = "pulso")
data_prueba <- haven::read_sav(data_prueba_ruta)

radar<-
  data_prueba %>% 
  select(starts_with("q0008_")) %>% 
  sjlabelled::label_to_colnames() %>%
  pivot_longer(everything(), names_to = "pregunta", values_to = "numero") %>%
  mutate(nombres=sjlabelled::as_label(numero)) %>% 
  group_by(pregunta, numero, nombres) %>%
  dplyr::summarize(Freq = n()) %>% 
  group_by(pregunta) %>% 
  dplyr::mutate(prop = round_half_up(Freq/sum(Freq), digits = 2),
                numero = as.character(numero),
                nombres = as.character(nombres)) %>% 
  separate(pregunta, c("Servicio","group", NA),  sep=" - ") %>% 
  filter(nombres!="No") %>%
  select(-c(numero, nombres, Freq)) %>%
  group_by(group) %>% 
  pivot_wider(names_from = Servicio, values_from = prop) %>% 
  mutate(
   group=case_when(
    group %in% "Conoce este servicio de bienestar que brinda la universidad" ~ "Lo conoce",
    TRUE ~ group)
  ) %>% 
  ungroup()

radar.tag<-
  data_prueba %>% 
  select(starts_with("q0008_")) %>% 
  nrow()

radar %>% 
  select(group, `Servicio de Salud`, `Servicio de actividad fisica y deportes`, `Bienestar psicologico`, `Servicios Culturales`) %>% 
  grafico_radar(polygonfill = FALSE,
         grid.label.size = 3,
         axis.label.size = 3,
         group.line.width = 1,
         fullscore = as.numeric(rep(1,ncol(.)-1))
         ) + 
  
  labs(caption = "Elaborado por Pulso PUCP",
       tag = glue("N=",radar.tag)) +
  
  theme(legend.title = element_blank(),legend.position = "bottom",legend.text = element_text(size=10, face = "bold",family="sans"),legend.key.height = unit(.2, "cm"),
        plot.caption = element_text(face = "italic",family="sans"),plot.margin = unit(c(0,0,1,0),"cm"),plot.tag = element_text(size = 8, color="grey40"),plot.tag.position = "topright",
        
        text = element_text(size = 9, color="#002060",family="sans"),
        ) +
  guides(color=guide_legend(nrow = 2, byrow = TRUE)) +
  coord_equal(clip="off")


```

